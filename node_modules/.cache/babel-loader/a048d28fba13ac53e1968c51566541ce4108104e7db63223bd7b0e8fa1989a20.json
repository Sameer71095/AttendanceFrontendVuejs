{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineComponent, h, Fragment, Teleport } from 'vue';\nimport { Calendar } from '@fullcalendar/core';\nimport { CustomRenderingStore } from '@fullcalendar/core/internal';\nimport { OPTION_IS_COMPLEX } from './options.js';\nconst FullCalendar = defineComponent({\n  props: {\n    options: Object\n  },\n  data() {\n    return {\n      renderId: 0,\n      customRenderingMap: new Map()\n    };\n  },\n  methods: {\n    getApi() {\n      return getSecret(this).calendar;\n    },\n    buildOptions(suppliedOptions) {\n      return {\n        ...suppliedOptions,\n        customRenderingMetaMap: kebabToCamelKeys(this.$slots),\n        handleCustomRendering: getSecret(this).handleCustomRendering\n      };\n    }\n  },\n  render() {\n    const teleportNodes = [];\n    for (const customRendering of this.customRenderingMap.values()) {\n      const innerContent = typeof customRendering.generatorMeta === 'function' ? customRendering.generatorMeta(customRendering.renderProps) :\n      // vue-normalized slot function\n      customRendering.generatorMeta; // probably a vue JSX node returned from content-inject func\n      teleportNodes.push(h(Teleport, {\n        key: customRendering.id,\n        to: customRendering.containerEl\n      }, innerContent));\n    }\n    return h('div', {\n      // when renderId is changed, Vue will trigger a real-DOM async rerender, calling beforeUpdate/updated\n      attrs: {\n        'data-fc-render-id': this.renderId\n      }\n    }, h(Fragment, teleportNodes)); // for containing Teleport keys\n  },\n\n  mounted() {\n    const customRenderingStore = new CustomRenderingStore();\n    getSecret(this).handleCustomRendering = customRenderingStore.handle.bind(customRenderingStore);\n    const calendarOptions = this.buildOptions(this.options);\n    const calendar = new Calendar(this.$el, calendarOptions);\n    getSecret(this).calendar = calendar;\n    calendar.render();\n    customRenderingStore.subscribe(customRenderingMap => {\n      this.customRenderingMap = customRenderingMap; // likely same reference, so won't rerender\n      this.renderId++; // force rerender\n      getSecret(this).needCustomRenderingResize = true;\n    });\n  },\n  beforeUpdate() {\n    this.getApi().resumeRendering(); // the watcher handlers paused it\n  },\n\n  updated() {\n    if (getSecret(this).needCustomRenderingResize) {\n      getSecret(this).needCustomRenderingResize = false;\n      this.getApi().updateSize();\n    }\n  },\n  beforeUnmount() {\n    this.getApi().destroy();\n  },\n  watch: buildWatchers()\n});\nexport default FullCalendar;\n// storing internal state:\n// https://github.com/vuejs/vue/issues/1988#issuecomment-163013818\nfunction getSecret(inst) {\n  return inst;\n}\nfunction buildWatchers() {\n  let watchers = {\n    // watches changes of ALL options and their nested objects,\n    // but this is only a means to be notified of top-level non-complex options changes.\n    options: {\n      deep: true,\n      handler(options) {\n        let calendar = this.getApi();\n        calendar.pauseRendering();\n        let calendarOptions = this.buildOptions(options);\n        calendar.resetOptions(calendarOptions);\n        this.renderId++; // will queue a rerender\n      }\n    }\n  };\n\n  for (let complexOptionName in OPTION_IS_COMPLEX) {\n    // handlers called when nested objects change\n    watchers[`options.${complexOptionName}`] = {\n      deep: true,\n      handler(val) {\n        // unfortunately the handler is called with undefined if new props were set, but the complex one wasn't ever set\n        if (val !== undefined) {\n          let calendar = this.getApi();\n          calendar.pauseRendering();\n          calendar.resetOptions({\n            [complexOptionName]: val\n          }, [complexOptionName]);\n          this.renderId++; // will queue a rerender\n        }\n      }\n    };\n  }\n\n  return watchers;\n}\n// General Utils\nfunction kebabToCamelKeys(map) {\n  const newMap = {};\n  for (const key in map) {\n    newMap[kebabToCamel(key)] = map[key];\n  }\n  return newMap;\n}\nfunction kebabToCamel(s) {\n  return s.split('-').map((word, index) => index ? capitalize(word) : word).join('');\n}\nfunction capitalize(s) {\n  return s.charAt(0).toUpperCase() + s.slice(1);\n}","map":{"version":3,"names":["defineComponent","h","Fragment","Teleport","Calendar","CustomRenderingStore","OPTION_IS_COMPLEX","FullCalendar","props","options","Object","data","renderId","customRenderingMap","Map","methods","getApi","getSecret","calendar","buildOptions","suppliedOptions","customRenderingMetaMap","kebabToCamelKeys","$slots","handleCustomRendering","render","teleportNodes","customRendering","values","innerContent","generatorMeta","renderProps","push","key","id","to","containerEl","attrs","mounted","customRenderingStore","handle","bind","calendarOptions","$el","subscribe","needCustomRenderingResize","beforeUpdate","resumeRendering","updated","updateSize","beforeUnmount","destroy","watch","buildWatchers","inst","watchers","deep","handler","pauseRendering","resetOptions","complexOptionName","val","undefined","map","newMap","kebabToCamel","s","split","word","index","capitalize","join","charAt","toUpperCase","slice"],"sources":["../src/FullCalendar.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}